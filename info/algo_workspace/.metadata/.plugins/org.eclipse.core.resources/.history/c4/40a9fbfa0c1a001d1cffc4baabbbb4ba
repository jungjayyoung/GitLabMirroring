package swea_ps;
import java.io.*;
import java.util.*;


public class Solution_d3_4012_요리사_서울_20반_정재영 {

	static int[][] board;
	static List<Integer> list; 
	static List<Integer> chosen; 
	static List<Integer> chosen2; 
	static List<Integer> food_list; 
	static int ans = 987654321;
	static int memo[][];
	
	
	
	
	static void bt(int cnt,int start) {
		
		if(cnt == 2) {
			
			int i = chosen.get(0);
			int j = chosen.get(1);
			// 0 에서 n-1의 재료들의 합이 저장된다.
			chosen2.add(board[i][j] + board[j][i]);
					
			return;
		}
		
		for(int i = start; i < list.size(); i++) {
			
			chosen.add(list.get(i));
			bt(cnt + 1, i + 1);
			chosen.remove(cnt);
			
		}
		
		
		
	}
	
	static void bt2(int cnt,int start) {
		
		if(cnt == 2) {
			
			int food_one = food_list.get(0);
			int food_two = food_list.get(1);
			
			ans = Math.min(ans, Math.abs(food_one - food_two));
			
			return;
		}
		
		
		for(int i = start; i < chosen2.size();i++) {
			
			food_list.add(chosen2.get(i));
			bt2(cnt+1, i+1);
			food_list.remove(cnt);
			
		}
		
		
	}
	
	public static void main(String[] args) throws IOException{
		BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
		StringTokenizer st;
		
		int tt = Integer.parseInt(br.readLine());
		
		for(int t = 1; t <= tt; t++) {
			
			list = new ArrayList<Integer>();
			chosen = new ArrayList<Integer>();
			chosen2 = new ArrayList<Integer>();
			food_list = new ArrayList<Integer>();
			ans = 987654321;
			
			int n = Integer.parseInt(br.readLine());
			board = new int[n+1][n+1];
			memo = new int[n+1][n+1];
			
			for(int  y = 0; y <n;y++) {
				st = new StringTokenizer(br.readLine()," ");
				list.add(y); // 재료를 전부 리스트에 담는다
				for(int x = 0; x <n; x++) {
					
					board[y][x] = Integer.parseInt(st.nextToken());
				}
			}
			
			bt(0,0);
			
			System.out.println("#" + t +" " +ans);
		
		}
		
	}

}
